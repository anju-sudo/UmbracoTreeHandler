<div ng-controller="multiCheckboxDropdownController" class="usergroup-dropdown">
    <div class="dropdown-wrapper">
        <div class="dropdown-toggle"
             ng-click="toggleDropdown()"
             ng-class="{ 'disabled': !isAdmin, 'admin-only': !isAdmin }">
            {{ getDisplayText() }}
            <span ng-if="!isAdmin" class="admin-required-text">⚡ Only manageable by Admin</span>
        </div>
        <div class="dropdown-menu" ng-show="dropdownOpen && isAdmin">
            <div class="checkbox-item" ng-repeat="group in userGroups">
                <label>
                    <input type="checkbox"
                           ng-checked="model.value.indexOf(group.alias) > -1"
                           ng-click="toggleGroup(group.alias)" />
                    {{ group.name }}
                </label>
            </div>
        </div>
    </div>
</div>

<style>
    .usergroup-dropdown {
        position: relative;
        width: 100%;
        font-family: sans-serif;
    }

        .usergroup-dropdown .dropdown-toggle {
            background: #fff;
            border: 1px solid #ccc;
            padding: 8px 10px;
            cursor: pointer;
            border-radius: 4px;
            user-select: none;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

            .usergroup-dropdown .dropdown-toggle:hover {
                border-color: #999;
                box-shadow: 0 0 4px rgba(0, 0, 0, 0.1);
            }

            .usergroup-dropdown .dropdown-toggle:after {
                content: '▾';
                float: right;
                margin-left: 10px;
                color: #666;
            }

            /* Disabled state styles */
            .usergroup-dropdown .dropdown-toggle.disabled {
                background: linear-gradient(135deg, #2196F3, #1976D2);
                color: #fff;
                cursor: not-allowed;
                border: 1px solid #1976D2;
                position: relative;
                padding: 12px 15px;
                box-shadow: 0 2px 4px rgba(33, 150, 243, 0.2);
            }

                .usergroup-dropdown .dropdown-toggle.disabled:hover {
                    border-color: #1976D2;
                    box-shadow: 0 2px 6px rgba(33, 150, 243, 0.3);
                    background: linear-gradient(135deg, #1E88E5, #1565C0);
                }

                .usergroup-dropdown .dropdown-toggle.disabled:after {
                    content: '🔒';
                    color: #fff;
                    font-size: 14px;
                }

    .admin-required-text {
        font-size: 12px;
        color: #fff;
        font-weight: 500;
        margin-left: 8px;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    /* Additional styling for disabled state content */
    .usergroup-dropdown .dropdown-toggle.disabled {
        font-weight: 500;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    .usergroup-dropdown .dropdown-menu {
        position: absolute;
        top: calc(100% + 4px);
        left: 0;
        width: 100%;
        background: #fff;
        border: 1px solid #ccc;
        border-radius: 4px;
        max-height: 200px;
        overflow-y: auto;
        z-index: 999;
        padding: 6px 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }

    .usergroup-dropdown .checkbox-item {
        margin-bottom: 4px;
    }

    .usergroup-dropdown label {
        display: flex;
        align-items: center;
        cursor: pointer;
    }

    .usergroup-dropdown input[type="checkbox"] {
        margin-right: 6px;
    }
</style>